<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nagi plus</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: white;
            scroll-behavior: smooth;
        }
        .header {
            height: 300px;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        .content {
            padding: 20px;
        }
        .details h1 {
            font-size: 24px;
            margin: 10px 0;
        }
        .details p {
            margin: 5px 0;
        }
        .buttons {
            margin: 10px 0;
            display: flex;
            gap: 10px;
        }
        .btn-lang, .btn-subtitles, .btn-episode, .btn-download {
            background-color: #333;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
        }
        .btn-download {
            background-color: #FFD700; /* Dorado */
            color: black; /* Texto negro */
            margin-left: auto;
            position: relative;
            overflow: hidden;
        }
        .btn-download::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.3);
            transition: left 0.5s;
        }
        .btn-download:hover::before {
            left: 100%;
        }
        .season-list, .episode-list {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .season-item, .episode-item {
            background-color: #444;
            padding: 10px;
            cursor: pointer;
            text-align: center;
            width: 100px;
            position: relative;
            transition: background-color 0.3s, color 0.3s;
        }
        .episode-item.selected, .season-item.selected {
            background-color: white;
            color: black;
        }
        .episodes {
            display: none;
        }
        .episode-item::before {
            content: attr(data-label);
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 8px;
            color: white;
            background-color: #34568B;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .btn-lang {
            background: linear-gradient(to right, #00FF00, #FF0000, #FF69B4, #FFFFE0);
            border-radius: 10px;
            color: #000;
            text-shadow: 1px 1px 2px #000;
            transition: background-position 0.5s ease-in-out;
        }
        .btn-lang:hover {
            background-position: 100% 0;
        }
    </style>
</head>
<body>
    <div class="header" id="videoSection">
        <iframe id="videoPlayer" src=""></iframe> <!-- URL inicial -->
    </div>
    <div class="content">
        <div class="details">
            <h1>One Piece T1</h1>
            <p>Publicado: 1999 | Acción | Aventura | Fantasía</p>
            <p>Sinopsis: Monkey D. Luffy, un niño que consumió una "fruta del diablo", decide seguir los pasos de su ídolo, el pirata Shanks, y encontrar el One Piece. Por supuesto, le ayuda que su cuerpo tenga las propiedades del caucho y que esté rodeado de un grupo de hábiles luchadores y ladrones que lo ayudarán en el camino.</p>
            <div class="buttons">
                <button class="btn-lang" onclick="toggleFullscreen()">Pantalla Completa</button> 
                <button class="btn-subtitles">Selecciona un capítulo</button>
                <button class="btn-episode">Selecciona un capítulo</button>
                <button class="btn-download">Descargar</button> <!-- Botón de descarga -->
            </div>
            <div class="seasons">
                <h3>Temporadas</h3>
                <div class="season-list">
                    <div class="season-item" data-season="1">Temporada 1</div>
                </div>
            </div>
            <div class="episodes" id="episodesSection" style="display: none;">
                <h3>Capítulos</h3>
                <div class="episode-list">
                    <!-- Capítulos se mostrarán aquí -->
                </div>
            </div>
        </div>
    </div>
    <script>
        const seasonItems = document.querySelectorAll('.season-item');
        const episodeList = document.querySelector('.episode-list');
        const episodesSection = document.getElementById('episodesSection');
        const videoPlayer = document.getElementById('videoPlayer');
        const videoSection = document.getElementById('videoSection');
        const episodeButton = document.querySelector('.btn-episode');
        const subtitlesButton = document.querySelector('.btn-subtitles');
        const downloadButton = document.querySelector('.btn-download');
        const capítulos = [
            { temporada: 1, episodios: Array.from({length: 1122}, (_, i) => `Episodio ${i + 1}`) },
        ];
        // URLs de visualización de los episodios por temporada
        const urlsVisualización = {
            1: [
                'https://nagi-plus4.github.io/solo_vid.github.io/One-piece-T1-E1.html', 
                'https://nagi-plus4.github.io/solo_vid.github.io/One-piece-T1-E2.html', 
                'https://nagi-plus4.github.io/solo_vid.github.io/One-piece-T1-E4.html',
                'https://nagi-plus4.github.io/solo_vid.github.io/One-piece-T1-E5.html',
                'https://nagi-plus4.github.io/solo_vid.github.io/One-piece-T1-E6.html',
                'https://nagi-plus4.github.io/solo_vid.github.io/One-piece-T1-E7.html',
                'https://nagi-plus4.github.io/solo_vid.github.io/One-piece-T1-E8.html',
                // ... más URLs para otros capítulos de la temporada 1
            ]
        };
        // URLs de descarga de los episodios por temporada
        const urlsDescarga = {
            1: [
                'https://example.com/download/season1/episode1.mp4',
                'https://example.com/download/season1/episode2.mp4',
                'https://example.com/download/season1/episode3.mp4',
                // ... más URLs para otros capítulos de la temporada 1
            ]
        };
        function saveProgress(season, episode, url) {
            localStorage.setItem('lastWatchedEpisode', JSON.stringify({season, episode, url}));
        }
        function loadProgress() {
            const savedData = localStorage.getItem('lastWatchedEpisode');
            return savedData ? JSON.parse(savedData) : null;
        }
        function highlightSavedEpisode() {
            const savedData = loadProgress();
            if (savedData) {
                episodeButton.textContent = savedData.episode;
                videoPlayer.src = savedData.url;
                const episodeIndex = capítulos[savedData.season - 1].episodios.indexOf(savedData.episode);
                if (episodeIndex !== -1) {
                    downloadButton.textContent = `Descargar ${savedData.episode}`;
                    downloadButton.onclick = () => {
                        window.open(urlsDescarga[savedData.season][episodeIndex] || '#', '_blank');
                    };
                    document.querySelectorAll('.episode-item').forEach(item => {
                        if (item.textContent === savedData.episode) {
                            item.classList.add('selected');
                        }
                    });
                }
                document.querySelectorAll('.season-item').forEach(item => {
                    if (parseInt(item.dataset.season) === savedData.season) {
                        item.classList.add('selected');
                        item.click(); // Abre la temporada guardada
                    }
                });
            }
        }
        seasonItems.forEach(item => {
            item.addEventListener('click', () => {
                const season = parseInt(item.dataset.season);
                episodeList.innerHTML = ''; // Limpia la lista de capítulos
                const episodiosTemporada = capítulos.find(cap => cap.temporada === season);
                if (episodiosTemporada) {
                    episodiosTemporada.episodios.forEach((episodio, index) => {
                        const episodeItem = document.createElement('div');
                        episodeItem.classList.add('episode-item');
                        episodeItem.textContent = episodio;
                        let label = 'SUB';
                        if (
                            (season === 1 && index === 9) || // Temporada 1, episodio 10 en ES
                            (season === 2 && index < 5) ||   // Temporada 2, primeros 5 episodios en ES
                            (season === 3 && index < 2) ||   // Temporada 3, primeros 2 episodios en ES
                            (season === 4 && index < 7)      // Temporada 4, primeros 7 episodios en ES
                        ) {
                            label = 'ES';
                        }
                        episodeItem.setAttribute('data-label', label);
                        episodeItem.addEventListener('click', () => {
                            let urlVisualización = urlsVisualización[season][index];
                            let urlDescarga = urlsDescarga[season][index];
                                                        videoPlayer.src = urlVisualización;
                                                        // Desplaza hacia arriba al video
                            videoSection.scrollIntoView();
                            // Guarda la temporada y el episodio seleccionado con su URL
                            saveProgress(season, episodio, urlVisualización);
                            // Cambia el texto del botón al capítulo seleccionado
                            episodeButton.textContent = episodio;
                            // Cambia el texto del botón de subtítulos según el idioma
                            subtitlesButton.textContent = label === 'ES' ? 'Español' : 'Subtitulado';
                            // Actualiza el botón de descarga
                            downloadButton.textContent = `Descargar ${episodio}`;
                            downloadButton.onclick = () => {
                                window.open(urlDescarga, '_blank');
                            };
                            // Cambia el color del episodio seleccionado
                            document.querySelectorAll('.episode-item').forEach(el => el.classList.remove('selected'));
                            episodeItem.classList.add('selected');
                        });
                        episodeList.appendChild(episodeItem);
                    });
                    episodesSection.style.display = 'block'; // Muestra la sección de capítulos
                    document.querySelectorAll('.season-item').forEach(el => el.classList.remove('selected'));
                    item.classList.add('selected'); // Marca la temporada seleccionada
                }
            });
        });
        window.onload = function() {
            highlightSavedEpisode(); // Resalta el episodio guardado al cargar la página
        };
        function toggleFullscreen() {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                videoSection.requestFullscreen();
            }
        }
    </script>
</body>
</html>
